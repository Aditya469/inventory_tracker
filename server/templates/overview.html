{% extends 'base.html' %}

{% block title %}

{% endblock %}

{% block additionalHeadMaterial %}
<script type=text/javascript src="{{ url_for('scripts.getScriptFile', filename='overview.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='common.css')}}">
<link rel="stylesheet" href="{{ url_for('static', filename='overview.css')}}">
{% endblock %}

{% block content %}
<div id="contentContainer" class="container mt-2">
	<div class="row row-cols-sm-1 row-cols-md-2	">
		<div id="currentJobsContainer" class="col col-md-5 border">
			<h1>Jobs</h1>
			<div id="jobsContainerControls" class="row">
				<input class="col col-12 button" id="addJobButton" type="button" value="createNewJob" onclick="openJobDetailsPanel(-1)">
				<label class="col col-auto" id="jobSearchBarLabel" for="jobSearchBar">Search Term</label>
				<input class="col" id="jobSearchBar" placeholder="start typing..." oninput="updateJobsTable()">
			</div>
			<div id="jobsTableContainer">
			</div>
		</div>
		<div id="stockDisplayContainer" class="col col-md-7 border">
			<h1>Stock</h1>
			<div id="stockSearchControls pb-1">
				<label id="stockSearchBarLabel" for="stockSearchBar">Search Term</label>
				<input id="stockSearchBar" placeholder="start typing..." oninput="updateStockTables()">
			</div>
			<br>
			<div id="stockTableTabsContainer">
				<ul class="nav nav-tabs">
					<li class="nav-item">
						<a class="nav-link active" href="#totalStockPanel" data-bs-toggle="tab">Total Stock</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#availableStockPanel" data-bs-toggle="tab">Unassigned Stock</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#oldStockPanel" data-bs-toggle="tab">Near Expiry</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#expiredStockPanel" data-bs-toggle="tab">Expired</a>
					</li>
				</ul>
				<div id="stockOverviewTableContainer" class="tab-content overflow-auto">
					<div class="tab-pane fade show active" id="totalStockPanel">
						<div id="totalStockTableContainer"></div>
					</div>
					<div class="tab-pane fade" id="availableStockPanel">
						<div id="availableStockTableContainer"></div>
					</div>
					<div class="tab-pane fade" id="oldStockPanel">
						<div>
							<label id="stockDaysNearExpiryLabel" for="stockDaysNearExpiry">Show stock expiring in this many days</label>
							<input id="stockDaysNearExpiry" type="number" size="2">
						</div>
						<div id="oldStockTableContainer"></div>
					</div>
					<div class="tab-pane fade" id="expiredStockPanel">
						<div id="expiredStockTableContainer"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div id="greyout" hidden class="position-fixed top-0 start-0 vw-100 vh-100" onclick="closePanels()"></div>
<div id="editJobPanel" hidden class="container h-100 align-middle border bg-body position-absolute top-50 start-50 translate-middle position-fixed">
	<nav id="nav" class="navbar bg-light navbar-light w-100">
		<h1>Job Details</h1>
		<input class="btn-close" id="closeProductPanelBtn" type="button" onclick="closePanels()"/>
	</nav>
	<div class="row row-cols-xs-1 row-cols-sm-1 row-cols-md-1 row-cols-lg-2 overflow-scroll">
		<input id="jobId" type="hidden" class="editJobInput">
        <div class="col">
			<div class="row">
				<label class="col col-sm-4 col-form-label" for="jobName">Job Name:</label>
				<div class="col col-sm-8">
					<input class="form-control editJobInput" type="text" id="jobName">
				</div>
				<a class="col-12 text-end" id="jobQrCodeLink"href="">Download Job Identifier QR Code</a>
			</div>
            <div id="stockUsedContainer" class="col-12 h-auto">
				<h3 >Stock Used</h3>
				<div >
					<span>Total Cost: </span>
					<span id="totalCost" class="editJobInput"></span>
				</div>
				<div id="stockUsedTableContainer">
					<table class="table">
						<thead>
							<tr>
								<td>Product Name</td>
								<td>Quantity</td>
								<td>Cost</td>
							</tr>
						</thead>
						<tbody id="stockUsedTableBody">

						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div class="col">
			<h3>Required Stock</h3>
			<div class="col-12 row">
				<label class="col col-auto col-form-label" for="assignStockSearchBar">Search:</label>
				<div class="col">
					<input class="form-control editJobInput" id="assignStockSearchBar" placeholder="start typing..." oninput="onRequiredStockSearchBarInput()">
				</div>
			</div>
            <div class="col-12 row">
				<div class="col-6">
                	<select id="knownProductDropdown" class="form-select" onchange="onKnownProductSelectChange()">
					</select>
				</div>
                <div class="col col-6">
					<div class="input-group">
						<input class="form-control editJobInput" id="quantityToAssign" type="number" value="" placeholder="qty.">
						<span class="input-group-text col-form-label editJobInput" id="quantityUnitDisplay"></span>
					</div>
                </div>
				<input value="Remove" type="button" class="col col-3 btn btn-danger" id="removeAssignedStockButton" disabled onclick="onRemoveAssignedStockButtonClicked()">
				<input type="button" class="col col-3 offset-6 btn btn-secondary" id="assignStockButton" onclick="addStockToAssignedList()" value="Add">
            </div>
			<div id="assignedStockTableContainer">
				<table class="table">
					<thead>
						<tr>
							<td>
								<input type="checkbox" id="selectAllRequiredStock" onclick="onSelectAllRequiredStockClicked()">
								<label class="visually-hidden" for="selectAllRequiredStock">Select All</label>
							</td>
							<td>
								Product Name
							</td>
							<td>Quantity</td>
						</tr>
					</thead>
					<tbody id="assignedStockTableBody">

					</tbody>
				</table>
			</div>
		</div>
		<div class="col col-md-12 p-4">
			<div class="row">
				<input class="col col-md-3 btn btn-danger" id="deleteButton" type="button" onclick="deleteJob()" value="Delete This Job">
				<input class="col col-md-3 offset-md-6 btn btn-primary" id="saveButton" type="button" onclick="saveJobDetails()" value="Save">
			</div>
		</div>

		<span class="col col-md-3 offset-md-9" id="saveJobFeedbackSpan"></span>
	</div>
</div>
{% endblock %}
