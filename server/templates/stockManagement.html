<!--
Copyright 2022 DigitME2

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

{% extends 'base.html' %}

{% block title %}

{% endblock %}

{% block additionalHeadMaterial %}
<script type=text/javascript src="{{ url_for('scripts.getScriptFile', filename='stockManagement.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='common.css') }}">
{% endblock %}

{% block content %}
<div id="contentContainer" class="container mt-2">
    <div class="d-flex flex-row justify-content-between align-items-center">
        <h1>Items of Stock</h1>
        <a href="{{ url_for('stockManagement.getItemStickerSheet', idQty=18) }}">Get ID sticker sheet (temporary)</a>
    </div>
    <div id="displayControlsContainer">
        <div id="displayControls" class="row">
            <div id="searchControls" class="col-xs-12 col-sm-12 col-md-4 col-lg-3 border">
                <h4>Text Search</h4>
                <label class="" for="searchBar">Search Term:</label>
                <input class="form-control" id="searchBar" placeholder="Start typing..." oninput="updateStockTable()">
                <div class="form-check">
                    <label class="form-check-label" for="searchProductTypeName">Search by Product Names</label>
                    <input class="form-check-input" type="checkbox" id="searchProductTypeName" onclick="updateStockTable()">
                </div>
                <div class="form-check">
                    <label class="form-check-label" for="searchByDescriptors">Search by Descriptors</label>
                    <input class="form-check-input" type="checkbox" id="searchByDescriptors" oninput="updateStockTable()">
                </div>
                <div class="form-check">
                    <label class="form-check-label" for="searchByIdNumber">Search by Stock ID number</label>
                    <input class="form-check-input" type="checkbox" id="searchByIdNumber" oninput="updateStockTable()">
                </div>
                <div class="form-check">
                    <label class="form-check-label" for="searchByBarcode">Search by Product Barcode</label>
                    <input class="form-check-input" type="checkbox" id="searchByBarcode" oninput="updateStockTable()">
                </div>
            </div>
            <div id="expirySelectorControls" class="col-xs-12 col-sm-12 col-md-4 col-lg-3 border pb-1 ">
                <h4>Expiring Stock</h4>
                <div class="row">
                    <div id="expirytickBoxes col-12">
                        <div class="form-check">
                            <label class="form-check-label" for="canExpire">Only Show Expirable Stock</label>
                            <input class="form-check-input" type="checkbox" id="canExpire" onclick="onCanExpireCheckboxClicked()">
                        </div>
                        <div class="form-check">
                            <label class="form-check-label" for="limitExpiryDates">Limit Expiry Dates</label>
                            <input class="form-check-input" type="checkbox" id="limitExpiryDates" disabled oninput="updateStockTable()" onclick="onLimitExpiryDatesClicked()">
                        </div>
                    </div>
                    <div class="col-12">
                        <label for="startDate" class="">Expiry Range Start Date:</label>
                        <input type="date" class="form-control form-control-sm" id="startDate" disabled oninput="updateStockTable()"/>
                        <label for="endDate" class="">Expiry Range End Date:</label>
                        <input type="date" class="form-control form-control-sm" id="endDate" disabled oninput="updateStockTable()"/>
                    </div>

                </div>
            </div>
            <div id="priceRangeSelector" class="col-xs-12 col-sm-12 col-md-4 col-lg-3 border">
                <h4>Cost of Stock Items</h4>
                <div class="form-check">
                    <label class="form-check-label" for="limitByPrice">Limit Stock Cost Range</label>
                    <input class="form-check-input" type="checkbox" id="limitByPrice" onclick="onLimitByPriceCheckboxClicked()">
                </div>
                <label for="priceRangeStart">Cost Range Minimum (£.pp)</label>
                <input type="number" min="0" step="0.01" placeholder="10.00" id="priceRangeStart" oninput="updateStockTable()">
                <label for="priceRangeEnd">Cost Range Maximum (£.pp)</label>
                <input type="number" min="0" step="0.01" placeholder="10.00" id="priceRangeEnd" oninput="updateStockTable()">
            </div>
            <div id="sortingOptions" class="col-xs-12 col-sm-12 col-md-4 col-lg-3 border pb-1">
                <h4>Sorting Options</h4>
                <div class="form-check">
                    <input id="sortByProductNameAsc" class="form-check-input" type="radio" name="stockSortingOptions" value="productNameAsc" checked oninput="updateStockTable()">
                    <label for="sortByProductNameAsc" class="form-check-label">Product Name (Asc)</label>
                </div>
                <div class="form-check">
                    <input id="sortByProductNameDesc" class="form-check-input" type="radio" name="stockSortingOptions" value="productNameDesc" oninput="updateStockTable()">
                    <label for="sortByProductNameDesc" class="form-check-label">Product Name (Desc)</label>
                </div>
                <div class="form-check">
                    <input id="sortByDateAddedAsc" class="form-check-input" type="radio" name="stockSortingOptions" value="dateAddedAsc" oninput="updateStockTable()">
                    <label for="sortByDateAddedAsc" class="form-check-label">Date Added (oldest first)</label>
                </div>
                <div class="form-check">
                    <input id="sortByDateAddedDesc" class="form-check-input" type="radio" name="stockSortingOptions" value="dateAddedDesc" oninput="updateStockTable()">
                    <label for="sortByDateAddedDesc" class="form-check-label">Date Added (newest first)</label>
                </div>
                <div class="form-check">
                    <input id="sortByExpiryDateAsc" class="form-check-input" type="radio" name="stockSortingOptions" value="expiryDateAsc" oninput="updateStockTable()">
                    <label for="sortByExpiryDateAsc" class="form-check-label">Expiry Date (Asc)</label>
                </div>
                <div class="form-check">
                    <input id="sortByExpiryDateDesc" class="form-check-input" type="radio" name="stockSortingOptions" value="expiryDateDesc" oninput="updateStockTable()">
                    <label for="sortByExpiryDateDesc" class="form-check-label">Expiry Date (Desc)</label>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div id="stockTableOuterContainer" class="border">
        <div id="deletionControls">
            <input type="button" id="deleteStockButton" class="btn btn-danger" value="Delete Selected" onclick="onDeleteSelectedButtonClicked()" disabled/>
        </div>
        <div id="stockTableContainer">

        </div>
    </div>
</div>
<div id="greyout" hidden class="position-fixed top-0 start-0 vw-100 vh-100" onclick="closeStockItemPanel()"></div>
<div id="editStockItemPanel" hidden class="container w-75 h-75 align-middle border bg-body position-absolute top-50 start-50 translate-middle position-fixed">
	<nav id="nav" class="navbar bg-light navbar-light w-100">
		<h1>Stock Item Details</h1>
		<input class="btn-close" id="closeProductPanelBtn" type="button" onclick="closeStockItemPanel()"/>
	</nav>
	<div class="row">
		<input id="stockId" type="hidden" class="editStockPanelInput">
        <div class="col row">
            <div class="col-12 row">
                <label class="col col-form-label" for="productType">Product Type:</label>
                <select class="col form-select editStockPanelInput" id="productType">
                </select>
            </div>
            <div class="col-12 row">
                <label class="col col-form-label" for="quantityRemaining">Quantity Remaining:</label>
                <div class="col input-group">
                    <input class="form-control editStockPanelInput" id="quantityRemaining" type="number" value="">
                    <span class="input-group-text col-form-label editStockPanelInput" id="quantityUnitDisplay">Units</span>
                </div>
            </div>
            <div class="col-12 row">
                <label class="col form-label" for="isBulk">Is bulk product?:</label>
                <span class="col editStockPanelInput" id="isBulk"></span>
            </div>
            <div class="col-12 row">
                <label class="col" for="isCheckedIn">Is item checked in?:</label>
                <span class="col editStockPanelInput" id="isCheckedIn"></span>
            </div>
            <div class="col-12 row">
                <label class="col" for="price">Cost of this item:</label>
                <input class="col form-control editStockPanelInput" type="number" id="price">
            </div>
            <div class="col-12 row">
                <label class="col" for="location">Location:</label>
                <select class="col form-select editStockPanelInput" id="location" oninput="onLocationUpdated()"></select>
            </div>
        </div>
        <div class="col row">
            <div class="col-12 row">
                <label class="col-auto" for="productDescriptor1">Descriptor 1:</label>
                <span class="col editStockPanelInput" id="productDescriptor1"></span>
            </div>
            <div class="col-12 row">
                <label class="col-auto" for="productDescriptor2">Descriptor 2:</label>
                <span class="col editStockPanelInput" id="productDescriptor2"></span>
            </div>
            <div class="col-12 row">
                <label class="col-auto" for="productDescriptor3">Descriptor 3:</label>
                <span class="col editStockPanelInput" id="productDescriptor3"></span>
            </div>
            <div class="col-12 align-middle input-group row">
                <label class="col-4 col-form-label" for="stockItemExpires">Expires?:</label>
                <input class="col-auto form-check editStockPanelInput" type="checkbox" id="stockItemExpires"></input>
                <div class="row col-auto">
                    <input class="form-control form-control-sm editStockPanelInput" type="date" id="expiryDate">
                </div>
            </div>
            </div>
		<div class="col col-md-12 p-4	">
			<div class="row">
				<input class="col col-md-3 btn btn-danger" id="deleteButton" type="button" onclick="deleteStockItem()" value="Delete This Stock Item">
				<input class="col col-md-3 offset-md-6 btn btn-primary" id="saveButton" type="button" onclick="saveStockItemDetails()" value="Save">
			</div>
		</div>

		<span class="col col-md-3 offset-md-9" id="saveProductFeedbackSpan"></span>
	</div>
</div>
{% endblock %}